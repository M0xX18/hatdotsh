# Configuración de seguridad de Nginx para HatDotSh Reforged

# Deshabilitar versión de Nginx
server_tokens off;

# Headers de seguridad
add_header X-Frame-Options "SAMEORIGIN" always;
add_header X-Content-Type-Options "nosniff" always;
add_header X-XSS-Protection "1; mode=block" always;
add_header Referrer-Policy "no-referrer-when-downgrade" always;
add_header Content-Security-Policy "default-src 'self' http: https: data: blob: 'unsafe-inline' 'unsafe-eval'; frame-ancestors 'self';" always;
add_header X-DNS-Prefetch-Control "on" always;
add_header Strict-Transport-Security "max-age=63072000; includeSubDomains; preload" always;
add_header Permissions-Policy "camera=(), microphone=(), geolocation=()" always;

# Deshabilitar métodos HTTP no necesarios
if ($request_method !~ ^(GET|HEAD|POST|OPTIONS)$ ) {
    return 405;
}

# Limitar tamaño de body
client_max_body_size 100M;

# Timeouts
client_body_timeout 10s;
client_header_timeout 10s;
keepalive_timeout 65s;
send_timeout 10s;

# Nota: Para ocultar completamente el header Server, se requiere el módulo headers-more-nginx-module
# Por ahora, server_tokens off; ya oculta la versión de Nginx

